# شرح هيكل ومحتوى ملف بيانات تفاعلات الأدوية (drug_interactions_structured_data.json)

## مقدمة

هذا المستند يشرح بنية ملف `drug_interactions_structured_data.json` الذي تم إنشاؤه من تحليل ملفات بيانات تفاعلات الأدوية الأولية. الهدف من هذا الملف هو توفير بيانات شبه منظمة يمكن استخدامها في تطبيق الموبايل لعرض معلومات حول تفاعلات الأدوية المحتملة.

## الهيكل العام للملف

الملف عبارة عن قائمة (Array) بصيغة JSON. كل عنصر في هذه القائمة هو كائن (Object) يمثل **مادة فعالة رئيسية** واحدة تم العثور عليها في البيانات المصدر.

```json
[
  {
    "active_ingredient": "...",
    "parsed_interactions": [ ... ]
  },
  {
    "active_ingredient": "...",
    "parsed_interactions": [ ... ]
  },
  // ... المزيد من المواد الفعالة
]
```

## حقول الكائن الرئيسي (لكل مادة فعالة)

كل كائن رئيسي في القائمة يحتوي على الحقلين التاليين:

1.  **`active_ingredient`** (String):
    *   **الوصف:** يمثل اسم المادة الفعالة الرئيسية أو اسم المنتج كما ورد في المصدر الأصلي. قد يحتوي الاسم على تركيزات أو معلومات إضافية.
    *   **الاستخدام:** يُستخدم كمعرف أساسي للدواء أو المادة التي يتم البحث عن تفاعلاتها.

2.  **`parsed_interactions`** (List<Object>):
    *   **الوصف:** قائمة تحتوي على كائنات تمثل **التفاعلات الفردية المحتملة** أو التفاصيل المتعلقة بالمادة الفعالة الرئيسية (`active_ingredient`). تم استخلاص هذه التفاعلات عن طريق محاولة تقسيم النص الأصلي الطويل بناءً على أنماط معينة (مثل "اسم دواء :") وتقسيم الجمل.
    *   **ملاحظة هامة:** قد تكون هذه القائمة فارغة إذا لم يتم العثور على تفاعلات واضحة أو إذا كان النص الأصلي يشير إلى عدم وجود تفاعلات معروفة. في بعض الحالات التي فشل فيها التحليل التفصيلي، قد تحتوي هذه القائمة على عنصر واحد يمثل النص الأصلي كاملاً.
    *   **الاستخدام:** يتم المرور على هذه القائمة لعرض تفاصيل التفاعلات المختلفة المرتبطة بالمادة الفعالة الرئيسية.

## حقول كائن التفاعل الفردي (داخل قائمة `parsed_interactions`)

كل كائن داخل قائمة `parsed_interactions` يمثل تفاعلاً أو معلومة تفاعل واحدة، ويحتوي على الحقول التالية:

1.  **`interacting_substance`** (String | null):
    *   **الوصف:** يمثل **محاولة استخلاص** اسم المادة الفعالة الأخرى، أو الدواء، أو الفئة الدوائية التي تشارك في هذا التفاعل المحدد. تم استخلاصه غالبًا من النص الذي يسبق علامة النقطتين الرأسيتين (`:`) في النص الأصلي، أو من خلال البحث عن أسماء أدوية شائعة داخل الجملة.
    *   **القيم المحتملة:**
        *   اسم دواء/مادة (مثل: "warfarin", "Aspirin", "Antibiotics").
        *   قد يكون اسمًا عامًا أو عنوانًا فرعيًا تم التقاطه بالخطأ (مثل: "WARNINGS", "Intervention").
        *   قد يكون `null` إذا لم يتمكن السكربت من تحديد مادة متفاعلة بوضوح لهذه الجملة أو المقطع.
    *   **الاستخدام:** يمكن استخدامه لعرض الطرف الآخر من التفاعل. **تنبيه:** يجب التعامل مع القيم بحذر، فقد تحتاج إلى تنظيف (إزالة كلمات مثل "Drug Interactions") أو ربطها بقائمة أسماء أدوية/مواد فعالة قياسية، والتعامل مع حالة `null`.

2.  **`severity`** (String):
    *   **الوصف:** يمثل درجة الخطورة **المقدرة** لهذا التفاعل المحدد، بناءً على وجود كلمات مفتاحية معينة (مثل "severe", "contraindicated", "caution", "risk") داخل نص الوصف (`description`) الخاص بهذا التفاعل.
    *   **القيم المحتملة:**
        *   `"contraindicated"` (مضاد استطباب / خطير جدًا)
        *   `"severe"` (شديد)
        *   `"major"` (كبير)
        *   `"moderate"` (متوسط)
        *   `"minor"` (بسيط)
        *   `"unknown"` (غير معروف / لم يتم العثور على كلمات مفتاحية واضحة)
    *   **الاستخدام:** مهم جدًا لعرض مؤشر مرئي لخطورة التفاعل للمستخدم (مثل استخدام أيقونات أو ألوان مختلفة). **تنبيه:** هذه القيمة هي **تقدير** وليست مؤكدة 100%، وقد تحتاج إلى مراجعة أو استخدام مصادر أخرى للتحقق.

3.  **`description`** (String):
    *   **الوصف:** يحتوي على الجملة أو المقطع النصي المحدد من المصدر الأصلي الذي يصف هذا التفاعل الفردي. السكربت حاول تقسيم الأوصاف الطويلة إلى جمل، ولكن بعض الجمل قد تظل طويلة أو معقدة إذا كانت كذلك في المصدر.
    *   **الاستخدام:** يُستخدم لعرض الشرح التفصيلي للتفاعل للمستخدم، ويوفر السياق اللازم لفهم طبيعة التفاعل وتأثيره المحتمل.

## مثال توضيحي لجزء من الملف

```json
{
  "active_ingredient": "Povidone Iodine 10% v/v (equivalent to 1% titratable iodine) | Isopropyl Alcohol 70% v/v",
  "parsed_interactions": [
    {
      "interacting_substance": "aminoglutethimide", // تم استخلاصها من "Aminoglutethimide :"
      "severity": "minor", // تم تقديرها من الوصف
      "description": "Aminoglutethimide may lead to a loss of corticosteroid-induced adrenal suppression." // الجملة الأولى من الوصف
    },
    {
      "interacting_substance": "diuretics", // تم استخلاصها من الجملة التالية
      "severity": "unknown",
      "description": "Amphotericin B injection and potassium-depleting agents : When corticosteroids are administered concomitantly with potassium-depleting agents (ie, amphotericin B, diuretics), patients should be observed closely for development of hypokalemia." // الجملة الثانية
    },
    {
      "interacting_substance": "amphotericin b",
      "severity": "unknown",
      "description": "There have been cases reported in which concomitant use of amphotericin B and hydrocortisone was followed by cardiac enlargement and congestive heart failure." // الجملة الثالثة
    },
    {
      "interacting_substance": "Antibiotics", // تم استخلاصها من "Antibiotics:"
      "severity": "major",
      "description": "Macrolide antibiotics have been reported to cause a significant decrease in corticosteroid clearance."
    },
    // ... المزيد من التفاعلات المفصلة لنفس المادة الفعالة
  ]
}
```

## كيفية الاستخدام في التطبيق (Flutter كمثال)

1.  **تضمين الملف:** ضع ملف `drug_interactions_structured_data.json` في مجلد `assets` الخاص بمشروع Flutter وقم بتعريفه في ملف `pubspec.yaml`.
2.  **إنشاء نماذج Dart:** قم بإنشاء فئات (Classes) في Dart تمثل هيكل البيانات هذا (مثل `DrugData` تحتوي على `activeIngredient` وقائمة من `InteractionDetail`، حيث `InteractionDetail` تحتوي على `interactingSubstance`, `severity`, `description`).
3.  **التحميل والتحويل:** عند بدء تشغيل التطبيق أو عند الحاجة، قم بتحميل الملف باستخدام `rootBundle.loadString` ثم استخدم `json.decode` لتحويل النص إلى `List<Map<String, dynamic>>`. بعد ذلك، قم بتحويل هذه القائمة إلى قائمة من كائنات Dart التي أنشأتها.
4.  **البحث والعرض:**
    *   عندما يختار المستخدم دواءً (أو مادة فعالة)، ابحث في قائمة كائنات `DrugData` عن الكائن الذي يطابق `active_ingredient`.
    *   إذا تم العثور عليه، قم بالمرور على قائمة `parsed_interactions` الخاصة به.
    *   لكل `InteractionDetail` في القائمة:
        *   اعرض `interacting_substance` (مع التعامل مع `null`).
        *   اعرض مؤشرًا للخطورة بناءً على قيمة `severity`.
        *   اعرض `description` كتفاصيل إضافية.
5.  **فحص التفاعلات بين عدة أدوية:**
    *   احصل على قوائم `parsed_interactions` لكل الأدوية التي اختارها المستخدم.
    *   قارن بين `active_ingredient` و `interacting_substance` عبر القوائم المختلفة للعثور على تطابقات (تفاعلات مباشرة).
    *   يمكن استخدام الكود الموجود في `External_source/drug_interaction/` (بعد تفعيله وتكييفه) لتطبيق منطق أكثر تعقيدًا للبحث عن التفاعلات المباشرة وغير المباشرة بين قائمة أدوية.

## قيود وملاحظات

*   **الدقة:** عملية استخلاص `interacting_substance` وتقدير `severity` هي عملية تلقائية وقد تحتوي على أخطاء أو عدم دقة.
*   **الأوصاف المتبقية:** بعض الأوصاف (`description`) قد تظل طويلة نسبيًا إذا كانت الجملة الأصلية معقدة.
*   **التحقق:** يفضل دائمًا التحقق من صحة المعلومات الهامة من مصادر طبية موثوقة أو استشارة متخصصين. لا ينبغي الاعتماد على هذه البيانات فقط لاتخاذ قرارات طبية.
*   **التحديث:** هذه البيانات ثابتة وتمثل لقطة من المصدر الأصلي في وقت التحليل. قد تحتاج إلى آلية لتحديثها دوريًا.

نأمل أن يساعد هذا الشرح في استخدام البيانات بفعالية لتطوير ميزة تفاعلات الأدوية في تطبيقك.