ğŸ“¡ MediSwitch API Documentation
Base URL: https://mediswitch-api.admin-lotfy.workers.dev

ğŸ”“ Public Endpoints
Health Check
GET /api/health
Returns: { status: "healthy", version: "2.0" }

Statistics
GET /api/stats
Returns database statistics:

total_drugs - Total number of drugs
total_companies - Number of companies
recent_updates_7d - Drugs updated in last 7 days
total_users - Total registered users
active_subscriptions - Active subscriptions count
Subscription Plans
GET /api/plans
Returns list of available subscription plans

Drugs - Public
List Drugs
GET /api/drugs?page=1&limit=50&search=&category=&sortBy=updated_at&sortOrder=DESC
Query Parameters:

page (default: 1)
limit (default: 50, max: 100)
search
 - Search in trade_name, arabic_name, active
category - Filter by category
sortBy - Sort field (trade_name, price, updated_at, category, company)
sortOrder - ASC or DESC
Response:

{
  "data": [...],
  "pagination": {
    "page": 1,
    "limit": 50,
    "total": 15000,
    "totalPages": 300,
    "hasMore": true
  }
}
Get Single Drug
GET /api/drugs/:id
ğŸ” Authentication Endpoints
Register
POST /api/auth/register
Content-Type: application/json
{
  "email": "user@example.com",
  "password": "password123",
  "name": "John Doe"
}
Login
POST /api/auth/login
Content-Type: application/json
{
  "email": "user@example.com",
  "password": "password123"
}
ğŸ‘¨â€ğŸ’¼ Admin Endpoints
Users Management
List All Users
GET /api/admin/users
Returns all users with their subscription status

Subscriptions Management
List All Subscriptions
GET /api/admin/subscriptions
Returns all subscriptions with user and plan details

Drug Management (CRUD)
Get All Drugs (Admin)
GET /api/admin/drugs?page=1&limit=50&search=&sortBy=updated_at&sortOrder=DESC
Enhanced search includes: trade_name, arabic_name, active, company, category

Get Single Drug
GET /api/admin/drugs/:id
Create New Drug
POST /api/admin/drugs
Content-Type: application/json
{
  "trade_name": "Drug Name",
  "arabic_name": "Ø§Ø³Ù… Ø§Ù„Ø¯ÙˆØ§Ø¡",
  "active": "Active Ingredient",
  "company": "Company Name",
  "category": "Category",
  "price": 100.50,
  "description": "Description text",
  "image_url": "https://..."
}
Required fields: trade_name, active, company, category, price

Update Drug
PUT /api/admin/drugs/:id
Content-Type: application/json
{
  "price": 120.00,
  "trade_name": "Updated Name",
  "category": "New Category"
}
Updates only provided fields. Automatically updates updated_at timestamp.

Delete Drug
DELETE /api/admin/drugs/:id
ğŸ”„ Legacy Endpoints (Compatibility)
App Configuration
GET /api/config
Drug Interactions
GET /api/interactions?page=1&limit=100
ğŸ“Š Response Format
Success Response
{
  "data": {...},
  "message": "Success message",
  "pagination": {...}  // if applicable
}
Error Response
{
  "error": "Error message"
}
ğŸ”’ Authentication
For protected endpoints, include Authorization header:

Authorization: Bearer {token}
(Token system to be implemented)

ğŸ“ Notes
All timestamps are Unix timestamps (seconds since epoch)
All requests support CORS from any origin
Rate limiting: Not currently implemented
Maximum page size: 100 items
Version: 2.0
Last Updated: 2025-12-06