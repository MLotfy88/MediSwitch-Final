# ุฃููุงุท ุงููุธุงู - MediSwitch (System Patterns)

## ๐๏ธ ุงูุจููุฉ ุงููุนูุงุฑูุฉ (Architecture)

ูุนุชูุฏ ูุดุฑูุน **MediSwitch** ุนูู ูุจุงุฏุฆ **Clean Architecture** ูุถูุงู ูุตู ุงููุณุคูููุงุชุ ุณูููุฉ ุงูุตูุงูุฉุ ููุงุจููุฉ ุงูุงุฎุชุจุงุฑ. ูุชู ุชูุณูู ุงูุชุทุจูู ุฅูู ุซูุงุซ ุทุจูุงุช ุฑุฆูุณูุฉ:

```mermaid
graph TD
    UI[ุทุจูุฉ ุงูุนุฑุถ - Presentation Layer] --> Domain[ุทุจูุฉ ุงููุฌุงู - Domain Layer]
    Data[ุทุจูุฉ ุงูุจูุงูุงุช - Data Layer] --> Domain
    Data --> Remote[ูุตุฏุฑ ุจูุงูุงุช ุนู ุจุนุฏ - Remote Data Source]
    Data --> Local[ูุตุฏุฑ ุจูุงูุงุช ูุญูู - Local Data Source]
```

### 1. ุทุจูุฉ ุงูุนุฑุถ (Presentation Layer) - Flutter
ูุฐู ุงูุทุจูุฉ ูุณุคููุฉ ุนู ูู ูุง ูุฑุงู ุงููุณุชุฎุฏู ููุชูุงุนู ูุนู.
-   **ุงูุดุงุดุงุช (Screens)**: ุตูุญุงุช ุงูุชุทุจูู ุงููุงููุฉ (ูุซู ุงูุดุงุดุฉ ุงูุฑุฆูุณูุฉุ ุดุงุดุฉ ุงูุชูุงุตูู).
-   **ุงูุฃุฏูุงุช (Widgets)**: ููููุงุช ูุงุฌูุฉ ุงููุณุชุฎุฏู ุงููุงุจูุฉ ูุฅุนุงุฏุฉ ุงูุงุณุชุฎุฏุงู (ูุซู ุจุทุงูุฉ ุงูุฏูุงุกุ ุดุฑูุท ุงูุจุญุซ).
-   **ุฅุฏุงุฑุฉ ุงูุญุงูุฉ (State Management)**: ูุณุชุฎุฏู ููุชุจุฉ `Provider` ูุฅุฏุงุฑุฉ ุญุงูุฉ ุงูุชุทุจูู ุจุทุฑููุฉ ูุนุงูุฉ ูุจุณูุทุฉ.
-   **ุงูููุทู (Logic)**: ูุชู ูุตู ููุทู ุงูุนุฑุถ ูู ูุฆุงุช `Provider` (ุชุนูู ูู ViewModels) ุงูุชู ุชุชูุงุตู ูุน ุทุจูุฉ ุงููุฌุงู.

### 2. ุทุจูุฉ ุงููุฌุงู (Domain Layer) - Dart Pure
ูุฐู ูู ุงูุทุจูุฉ ุงูุฌููุฑูุฉ ููุชุทุจููุ ููู ูุณุชููุฉ ุชูุงููุง ุนู ุฃู ุฅุทุงุฑ ุนูู (Framework) ุฃู ูุตุฏุฑ ุจูุงูุงุช.
-   **ุงูููุงูุงุช (Entities)**: ุชูุซู ูุงุฆูุงุช ุงูุจูุงูุงุช ุงูุฃุณุงุณูุฉ ูู ุงูุชุทุจูู (ูุซู `DrugEntity`, `DosageResult`).
-   **ุญุงูุงุช ุงูุงุณุชุฎุฏุงู (Use Cases)**: ุชูุซู ุงูุนูููุงุช ุงูุชู ูููู ูููุณุชุฎุฏู ุงูููุงู ุจูุง (ูุซู `SearchDrugs`, `CalculateDose`). ูู ุญุงูุฉ ุงุณุชุฎุฏุงู ุชุบูู ููุทู ุนูู ูุงุญุฏ ููุญุฏุฏ.
-   **ูุงุฌูุงุช ุงููุณุชูุฏุนุงุช (Repository Interfaces)**: ุนููุฏ (Abstract Classes) ุชุญุฏุฏ ููููุฉ ุงููุตูู ููุจูุงูุงุช ุฏูู ูุนุฑูุฉ ุชูุงุตูู ุงูุชูููุฐ.

### 3. ุทุจูุฉ ุงูุจูุงูุงุช (Data Layer) - Dart
ูุฐู ุงูุทุจูุฉ ูุณุคููุฉ ุนู ุชูููุฑ ุงูุจูุงูุงุช ููุชุทุจููุ ุณูุงุก ูู ูุตุงุฏุฑ ูุญููุฉ ุฃู ุฎุงุฑุฌูุฉ.
-   **ุงูููุงุฐุฌ (Models)**: ุชูุซูู ุงูุจูุงูุงุช ุงููุงุฏูุฉ ูู ุงููุตุงุฏุฑ (JSON/DB) ูุชุญููููุง ุฅูู ููุงูุงุช.
-   **ุชูููุฐ ุงููุณุชูุฏุนุงุช (Repository Implementations)**: ุงููุฆุงุช ุงูุชู ุชุทุจู ูุงุฌูุงุช ุงููุณุชูุฏุนุงุช ูุชุฑุจุท ุจูู ูุตุงุฏุฑ ุงูุจูุงูุงุช ูุทุจูุฉ ุงููุฌุงู.
-   **ูุตุงุฏุฑ ุงูุจูุงูุงุช (Data Sources)**:
    -   **ูุญูู (Local)**: ูุงุนุฏุฉ ุจูุงูุงุช `SQLite` (ุจุงุณุชุฎุฏุงู `sqflite`) ูุชุฎุฒูู ุงูุจูุงูุงุช ุงูุฏูุงุฆูุฉุ ู `SharedPreferences` ููุฅุนุฏุงุฏุงุช ุงูุจุณูุทุฉ.
    -   **ุนู ุจุนุฏ (Remote)**: ุงุชุตุงู `HTTP` ูุน ุงูู Backend API ูุฌูุจ ุงูุชุญุฏูุซุงุช ูุงูุฅุนุฏุงุฏุงุช.

## ๐งฉ ุฃููุงุท ุงูุชุตููู ุงููุณุชุฎุฏูุฉ (Design Patterns)

1.  **ููุท ุงููุณุชูุฏุน (Repository Pattern)**: ููุตู ููุทู ุงููุตูู ููุจูุงูุงุช ุนู ููุทู ุงูุฃุนูุงูุ ููุง ูุณูุญ ุจุชุบููุฑ ูุตุงุฏุฑ ุงูุจูุงูุงุช ุจุณูููุฉ ุฏูู ุงูุชุฃุซูุฑ ุนูู ุจุงูู ุงูุชุทุจูู.
2.  **ุญูู ุงูุชุจุนูุงุช (Dependency Injection - DI)**: ุงุณุชุฎุฏุงู ููุชุจุฉ `get_it` ูู Service Locator ูุชูููุฑ ูุฅุฏุงุฑุฉ ุงูุชุจุนูุงุช ุนุจุฑ ุงูุชุทุจููุ ููุง ูุณูู ุงูุงุฎุชุจุงุฑ ููููู ุงูุงุฑุชุจุงุท (Coupling).
3.  **ุงูููุท ุงููุฑุฏู (Singleton Pattern)**: ูุณุชุฎุฏู ููููููุงุช ุงูุชู ูุฌุจ ุฃู ูููู ููุง ูุณุฎุฉ ูุงุญุฏุฉ ููุท ุทูุงู ุฏูุฑุฉ ุญูุงุฉ ุงูุชุทุจููุ ูุซู `DatabaseHelper` ู `FileLoggerService`.
4.  **ููุท ุงููุญูู (Adapter Pattern)**: ูุชุญููู ุงูุจูุงูุงุช ูู ุดูููุง ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุฃู API (Models) ุฅูู ุงูุดูู ุงููุณุชุฎุฏู ูู ุงูุชุทุจูู (Entities).
5.  **ููุท ุงููุฑุงูุจ (Observer Pattern)**: ูุชู ุชุทุจููู ุนุจุฑ `ChangeNotifier` ูู `Provider` ูุชุญุฏูุซ ูุงุฌูุฉ ุงููุณุชุฎุฏู ุชููุงุฆููุง ุนูุฏ ุชุบูุฑ ุงูุจูุงูุงุช.

## โ๏ธ ุงููุฑุงุฑุงุช ุงูุชูููุฉ ุงูุฑุฆูุณูุฉ

### ุงููุงุฌูุฉ ุงูุฃูุงููุฉ (Frontend - Flutter)
-   **ุฅุฏุงุฑุฉ ุงูุญุงูุฉ**: ุชู ุงุฎุชูุงุฑ `Provider` ูุณูููุชู ูููุงุกุชู ูููุงุณุจุชู ูุญุฌู ุงููุดุฑูุน ููุงุฑูุฉ ุจู BLoC ุงููุนูุฏ.
-   **ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงููุญููุฉ**: ุชู ุงุฎุชูุงุฑ `sqflite` ูุฃููุง ุชููุฑ ูุญุฑู SQL ูุงูู ููููุ ููู ุถุฑูุฑู ูุนูููุงุช ุงูุจุญุซ ุงููุนูุฏุฉ ูุงูุฑุจุท ุจูู ุงูุฌุฏุงูู (ุงูุฃุฏููุฉุ ุงูุจุฏุงุฆู).
-   **ุงูุชููู (Navigation)**: ุงุณุชุฎุฏุงู ูุธุงู ุงูุชููู ุงูุฃุณุงุณู ูู Flutter ูุน ุฏุนู ุงูุชููู ุงููุชุฏุงุฎู (Nested Navigation) ููุดุฑูุท ุงูุณููู.
-   **ุงูุดุจูุฉ (Networking)**: ุงุณุชุฎุฏุงู ููุชุจุฉ `http` ุงูููุงุณูุฉ ูุฎูุชูุง ูุณูููุชูุง ููููุงู ุงููุทููุจุฉ.

### ุงููุงุฌูุฉ ุงูุฎูููุฉ (Backend - Django)
-   **ุฅุทุงุฑ ุงูุนูู**: Django REST Framework (DRF) ูุจูุงุก API ููู ูุขูู ูุณุฑูุน ุงูุชุทููุฑ.
-   **ูุงุนุฏุฉ ุงูุจูุงูุงุช**: PostgreSQL ูุจูุฆุฉ ุงูุฅูุชุงุฌ (Production) ููุชุงูุชูุง ูุฃุฏุงุฆูุง ุงูุนุงููุ ู SQLite ููุชุทููุฑ ุงููุญูู.
-   **ุงููุตุงุฏูุฉ**: ุงุณุชุฎุฏุงู JWT (JSON Web Tokens) ูุชุฃููู ููุงุท ุงูุงุชุตุงู ุงูุฎุงุตุฉ ุจุงููุดุฑููู.
-   **ุงููุดุฑ (Deployment)**: ุงุณุชุฎุฏุงู Docker ูุชูุญูุฏ ุจูุฆุฉ ุงูุชุดุบููุ ูุน Nginx ูุฎุงุฏู ููุจ ุนูุณู (Reverse Proxy) ู Gunicorn ูุฎุงุฏู ุชุทุจููุงุช.

## ๐ ุชุฏูู ุงูุจูุงูุงุช (Data Flow)

ูุซุงู: **ุนูููุฉ ุงูุจุญุซ ุนู ุฏูุงุก**
1.  **ุงููุณุชุฎุฏู**: ูููู ุจุฅุฏุฎุงู ูุต ูู ุดุฑูุท ุงูุจุญุซ.
2.  **Provider**: ูุณุชูุจู ุงููุฏุฎูุงุช ููุณุชุฏุนู ุญุงูุฉ ุงูุงุณุชุฎุฏุงู `SearchDrugsUseCase`.
3.  **UseCase**: ูุทูุจ ุงูุจูุงูุงุช ูู `DrugRepository` (ุงููุงุฌูุฉ).
4.  **Repository**: ููุฑุฑ ูุตุฏุฑ ุงูุจูุงูุงุช (ูู ุญุงูุฉ ุงูุจุญุซุ ูุชูุฌู ุฏุงุฆููุง ูููุตุฏุฑ ุงููุญูู `LocalDataSource`).
5.  **DataSource**: ูููุฐ ุงุณุชุนูุงู SQL (`SELECT * FROM drugs WHERE name LIKE ...`) ุนูู ูุงุนุฏุฉ ุจูุงูุงุช SQLite.
6.  **Model**: ูุชู ุชุญููู ูุชุงุฆุฌ ุงูุงุณุชุนูุงู (Raw Data) ุฅูู ูุงุฆูุฉ ูู ูุงุฆูุงุช `MedicineModel`.
7.  **Repository**: ูููู ุจุชุญููู `MedicineModel` ุฅูู `DrugEntity` ููุนูุฏูุง.
8.  **UseCase**: ูุนูุฏ ุงูุจูุงูุงุช ุฅูู ุงูู `Provider`.
9.  **Provider**: ูุญุฏุซ ุงูุญุงูุฉ ููุนูู ุงูู UI.
10. **UI**: ุชููู ุงูุดุงุดุฉ ุจุฅุนุงุฏุฉ ุงูุจูุงุก ูุนุฑุถ ูุงุฆูุฉ ุงูุฃุฏููุฉ.

## ๐ก๏ธ ุงูุฃูุงู (Security)

-   **ุงูุงุชุตุงู (API)**: ุงูุชุฎุทูุท ูุงุณุชุฎุฏุงู HTTPS ูู ุจูุฆุฉ ุงูุฅูุชุงุฌ ูุชุดููุฑ ุงูุงุชุตุงู ุจูู ุงูุชุทุจูู ูุงูุฎุงุฏู.
-   **ุงูุจูุงูุงุช ุงููุญููุฉ**: ุงูุจูุงูุงุช ูุฎุฒูุฉ ูู SQLite ุจุดูู ุนุงุฏู. ุชู ุงูุชุฎูู ุนู ุงูุชุดููุฑ ุงููุญูู (SQLCipher) ูู ุงููุฑุญูุฉ ุงูุญุงููุฉ (MVP) ูุชุญุณูู ุงูุฃุฏุงุก ูุชูููู ุญุฌู ุงูุชุทุจููุ ูุธุฑูุง ูุฃู ุงูุจูุงูุงุช ุงูุฏูุงุฆูุฉ ุนุงูุฉ ูููุณุช ุญุณุงุณุฉ.
-   **ุงูุชุญูู ูู ุงููุฏุฎูุงุช**: ูุชู ุงูุชุญูู ูู ุตุญุฉ ุงูุจูุงูุงุช ูู ูู ูู ุงููุงุฌูุฉ ุงูุฃูุงููุฉ (ูุจู ุงูุฅุฑุณุงู) ูุงููุงุฌูุฉ ุงูุฎูููุฉ (ูุจู ุงููุนุงูุฌุฉ) ูููุน ุงููุฌูุงุช ูุงูุฃุฎุทุงุก.
