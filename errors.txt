[INFO] Checking storage permission (Android)...
[CRITICAL] Error determining log directory: Null check operator used on a null value
[CRITICAL] Could not obtain ANY valid directory for logging. Using console only.
[I] main: >>> ENTERING main() <<<
[I] main: Date formatting initialized.
[I] --- Starting Full Locator Setup ---
[I] Locator: Waiting for SharedPreferences and DatabaseHelper...
[I] Locator: Registering SharedPreferences...
[I] Locator: Registering DatabaseHelper...
[I] Locator: SharedPreferences registered.
[I] Locator: DatabaseHelper registered and DB initialized.
[I] Locator: SharedPreferences and DatabaseHelper ready.
[I] Locator: Registering Use Cases...
[I] Locator: Registering Services...
[I] Locator: Registering Providers...
[I] Locator: Waiting for all async singletons...
[I] --- Full Locator Setup Complete ---
[I] main: Locator setup complete. Logger obtained.
[I] main: Starting application setup...
[I] main: Initializing Mobile Ads SDK...
[I] main: Mobile Ads SDK initialized.
[I] main: Initializing SubscriptionProvider asynchronously...
[I] Locator: Registering http.Client.
[I] main: Setup complete. Preparing to run MyApp...
[I] main: Setting InitializationScreen as initial route.
[I] main: >>> CALLING runApp() NOW <<<
[I] main: runApp called successfully (or at least the call was made).
[I] MyApp: Building widget tree...
[D] MyApp: Creating SettingsProvider...
[I] SettingsProvider: Constructor called.
[I] SettingsProvider: _loadSettings started.
[D] MyApp: Consumer<SettingsProvider> builder running. Initialized: false
[V] MyApp: SettingsProvider not initialized, showing loading indicator.
[I] Settings loaded: Theme=ThemeMode.system, Locale=ar
[D] MyApp: Consumer<SettingsProvider> builder running. Initialized: true
[V] MyApp: SettingsProvider initialized, building main MaterialApp.
[I] InitializationScreen: initState called.
[D] InitializationScreen: Building loading indicator UI.
[I] InitializationScreen: Determining initial route...
[I] Locator: Registering SqliteLocalDataSource...
[I] InitializationScreen: Flags - OnboardingDone: false
[I] InitializationScreen: Routing to OnboardingScreen.
[I] InitializationScreen: Navigating to OnboardingScreen
[D] OnboardingScreen: Building widget.
[D] OnboardingScreen: Building widget.
[D] OnboardingScreen: Building widget.
[D] OnboardingScreen: Building widget.
[I] OnboardingScreen: Onboarding complete.
[I] OnboardingScreen: Set onboarding complete flag.
[I] OnboardingScreen: Navigating back to InitializationScreen.
[I] InitializationScreen: initState called.
[D] InitializationScreen: Building loading indicator UI.
[I] InitializationScreen: Determining initial route...
[I] InitializationScreen: Flags - OnboardingDone: true
[I] InitializationScreen: Onboarding complete. Checking if database has medicines...
[I] InitializationScreen: Database has medicines: false
[I] InitializationScreen: Database is empty. Routing to SetupScreen for seeding.
[I] InitializationScreen: Navigating to SetupScreen
[I] SetupScreen: initState called. Starting initial seeding...
[D] SetupScreen: Building widget. isSeeding: true, error: null
[I] SetupScreen: Seeding process finished. Was seeding performed?: false. Duration: 2446ms
[I] SetupScreen: Seeding complete. Navigating to MainScreen...
[I] MainScreen: Building widget. Selected index: 0
[I] HomeScreen: +++++ initState +++++
[I] HomeScreen: >>>>> build ENTRY <<<<<
[D] MyApp: Creating MedicineProvider...
[I] Locator: Registering DrugRepository...
[I] Locator: Registering DrugRemoteDataSource...
[I] MedicineProvider: Constructor called.
[I] MedicineProvider: >>> ENTERING loadInitialData (forceUpdate: false) <<<
[I] MedicineProvider: loadInitialData called but already loading. Skipping.
[D] HomeScreen BUILD State: isLoading=true, isLoadingMore=false, isInitialLoadComplete=false, error='', displayed=0, recent=0, popular=0, hasMore=true
[V] HomeScreen: build - State read successfully. Returning Scaffold...
[V] HomeScreen: Building loading indicator.
[I] HomeScreen: >>>>> build EXIT <<<<<
[I] SearchScreen: +++++ initState +++++. Initial query: ''
[I] SearchScreen: >>>>> build ENTRY <<<<<
[D] SearchScreen BUILD State: isLoading=true, error='', results=0
[V] SearchScreen: build - State read successfully. Returning Scaffold...
[I] SearchScreen: >>>>> build EXIT <<<<<
[I] SettingsScreen: Building widget...
[D] SetupScreen: Building widget. isSeeding: false, error: null
[I] HomeScreen: Triggering initial data load from initState.
[I] MedicineProvider: >>> ENTERING loadInitialData (forceUpdate: false) <<<
[I] MedicineProvider: loadInitialData called but already loading. Skipping.
[I] SearchScreen: Debounced search triggered with query: ''
[D] MedicineProvider: setSearchQuery called with query: ''
[I] MedicineProvider: _applyFilters ENTRY - Page: 0, Append: false, ReqLimit: 15, FetchLimit: 16, Offset: 0, Query: '', Category: '', DosageForm: '', PriceRange: null
[I] MedicineProvider: Preparing to call UseCase. Query: '', Category: '', Page: 0, Fetch Limit: 16, Offset: 0, Append: false
[D] MedicineProvider: UseCase PARAMS - Query: '', Limit: 16, Offset: 0, Category: ''
[D] MedicineProvider: Applying no primary filter, fetching all (page 0)...
[D] DrugRepository: searchDrugs called with query: '', limit: 16, offset: 0
[I] DrugRepository: searchDrugs successful, found 16 drugs.
[I] MedicineProvider: _applyFilters - UseCase SUCCESS (Page: 0, Append: false). Fetched 16 items.
[D] MedicineProvider: Applying secondary local filters (Dosage: '', Price: null)...
[I] MedicineProvider: Filtering complete for page 0. New items count: 16
[D] MedicineProvider: hasMoreItems set to true. Items received: 16, Items to add: 15
[I] MedicineProvider: Filtering complete for page 0. Final items to add count: 15
[I] MedicineProvider: Calculated price range based on current list: 0.0 - 1100.0
[I] MedicineProvider: _applyFilters EXIT - Page: 0, Append: false. Final State: isLoading=false, isLoadingMore=false, hasMore=true, filteredCount=15, error=''
[I] MainScreen: _onItemTapped called with index: 1
[I] MainScreen: Building widget. Selected index: 1
[I] MainScreen: _onItemTapped called with index: 0
[I] MainScreen: Building widget. Selected index: 0
[I] MainScreen: _onItemTapped called with index: 4
[I] MainScreen: Building widget. Selected index: 4
[I] SettingsScreen: View Logs tile tapped.